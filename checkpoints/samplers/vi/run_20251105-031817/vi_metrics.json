{
  "sampler_type": "vi",
  "config": {
    "batch_size": 16,
    "train_samples": 10000,
    "max_seq_length": 128,
    "num_epochs": 15,
    "learning_rate": 0.0001,
    "temperature": 1,
    "vi_n_samples": 1,
    "prior_std": 1,
    "prior_strength": 10.0,
    "init_log_scale": -5,
    "max_log_scale": 2,
    "prior_beta": 0.0005,
    "num_samples": 10,
    "max_new_tokens": 100,
    "generation_temperature": 0.8,
    "save_dir": "checkpoints/samplers",
    "wandb_project": "bayesian-nanogpt",
    "weight_decay": 0.01,
    "kl_weight": 1.0
  },
  "training_metrics": {
    "training_losses": [
      0.6892462968826294,
      0.5222587585449219,
      0.39848192036151886,
      0.30966244637966156,
      0.24684502184391022,
      0.20266945287585258,
      0.1711181439459324,
      0.14807625859975815,
      0.1306356079876423,
      0.11690252553671598,
      0.1055993102490902,
      0.0959613211452961,
      0.08756530983373523,
      0.0800525271333754,
      0.07320599118247628
    ],
    "log_posterior_values": [
      -11829.5009765625,
      -10159.6259765625,
      -8921.857421875,
      -8033.66259765625,
      -7405.48828125,
      -6963.732666015625,
      -6648.2197265625,
      -6417.800537109375,
      -6243.394287109375,
      -6106.063232421875,
      -5993.03125,
      -5896.6513671875,
      -5812.691162109375,
      -5737.5634765625,
      -5669.097900390625
    ],
    "epoch_times": [
      7.022534,
      5.937345,
      4.620736,
      4.458756,
      4.326709,
      4.201597,
      4.584275,
      4.523162,
      4.889239,
      4.140071,
      4.385719,
      4.618154,
      4.519176,
      4.531081,
      4.809174
    ],
    "sampler_specific_metrics": [
      {
        "epoch": 0,
        "avg_parameter_std": 0.006739090662449598
      },
      {
        "epoch": 1,
        "avg_parameter_std": 0.006740082520991564
      },
      {
        "epoch": 2,
        "avg_parameter_std": 0.006741014774888754
      },
      {
        "epoch": 3,
        "avg_parameter_std": 0.00674191489815712
      },
      {
        "epoch": 4,
        "avg_parameter_std": 0.0067427936010062695
      },
      {
        "epoch": 5,
        "avg_parameter_std": 0.006743657868355513
      },
      {
        "epoch": 6,
        "avg_parameter_std": 0.006744513288140297
      },
      {
        "epoch": 7,
        "avg_parameter_std": 0.0067453584633767605
      },
      {
        "epoch": 8,
        "avg_parameter_std": 0.006746196653693914
      },
      {
        "epoch": 9,
        "avg_parameter_std": 0.006747029721736908
      },
      {
        "epoch": 10,
        "avg_parameter_std": 0.006747857667505741
      },
      {
        "epoch": 11,
        "avg_parameter_std": 0.0067486814223229885
      },
      {
        "epoch": 12,
        "avg_parameter_std": 0.006749502383172512
      },
      {
        "epoch": 13,
        "avg_parameter_std": 0.006750320550054312
      },
      {
        "epoch": 14,
        "avg_parameter_std": 0.006751135922968388
      }
    ]
  },
  "timestamp": "2025-11-05T03:18:17.854241",
  "evaluation": {
    "deterministic": {
      "loss": 0.691402792930603,
      "perplexity": 1.9965142011642456
    },
    "posterior_mean": {
      "loss": 0.12909090518951416,
      "perplexity": 1.1377935409545898,
      "improvement_over_deterministic": 0.5623118877410889,
      "better_than_deterministic": true
    },
    "posterior_sampling": {
      "mean_loss": 0.15095969140529633,
      "std_loss": 0.012154039091876045,
      "min_loss": 0.13304804265499115,
      "max_loss": 0.16755323112010956,
      "num_samples": 5
    },
    "uncertainty": {
      "avg_predictive_entropy": 0.5124465227127075,
      "max_predictive_entropy": 2.208862066268921,
      "min_predictive_entropy": 0.012872744351625443
    },
    "parameter_uncertainty": {
      "avg_parameter_std": 0.006751226140058384
    }
  }
}